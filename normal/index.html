<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Normal + Normal</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <style>
    :root { --primary: #6366f1; --bg: #0f172a; --surface: #1e293b; --text: #f1f5f9; --muted: #94a3b8; }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); padding: 2rem; }
    .container { max-width: 900px; margin: 0 auto; }
    header { text-align: center; margin-bottom: 2rem; }
    h1 { font-size: 2rem; background: linear-gradient(135deg, var(--primary), #8b5cf6); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    .subtitle { color: var(--muted); }
    .viz { background: var(--surface); border-radius: 16px; padding: 1.5rem; margin-bottom: 1.5rem; }
    .viz svg { width: 100%; height: 250px; }
    .controls { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin: 1rem 0; }
    .ctrl { background: var(--surface); padding: 1rem; border-radius: 12px; }
    .ctrl label { display: block; margin-bottom: 0.5rem; }
    .ctrl input { width: 100%; }
    .info { background: var(--surface); border-radius: 12px; padding: 1.5rem; border-left: 4px solid var(--primary); }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>ðŸ”” Normal + Normal</h1>
      <p class="subtitle">Known variance â€” inferring the mean</p>
    </header>
    <div class="controls">
      <div class="ctrl"><label>Prior Mean (Î¼â‚€): <span id="mu0Val">0</span></label><input type="range" id="mu0" min="-5" max="5" step="0.1" value="0"></div>
      <div class="ctrl"><label>Prior Precision (Ï„â‚€): <span id="tau0Val">0.5</span></label><input type="range" id="tau0" min="0.1" max="2" step="0.1" value="0.5"></div>
      <div class="ctrl"><label>Data Mean (È³): <span id="ybarVal">2</span></label><input type="range" id="ybar" min="-5" max="5" step="0.1" value="2"></div>
      <div class="ctrl"><label>Sample Size (n): <span id="nVal">10</span></label><input type="range" id="n" min="1" max="100" value="10"></div>
    </div>
    <div class="viz"><h3>Prior (red) â†’ Posterior (green)</h3><svg id="chart"></svg></div>
    <div class="info">
      <strong>Update:</strong> Posterior precision Ï„â‚™ = Ï„â‚€ + n/ÏƒÂ², posterior mean Î¼â‚™ = (Ï„â‚€Î¼â‚€ + nÈ³/ÏƒÂ²) / Ï„â‚™
    </div>
  </div>
  <script>
    function normalPDF(x, mu, sigma) { return Math.exp(-0.5 * Math.pow((x-mu)/sigma, 2)); }
    function update() {
      const mu0 = parseFloat(document.getElementById('mu0').value);
      const tau0 = parseFloat(document.getElementById('tau0').value);
      const ybar = parseFloat(document.getElementById('ybar').value);
      const n = parseInt(document.getElementById('n').value);
      const sigma = 1; // known
      document.getElementById('mu0Val').textContent = mu0;
      document.getElementById('tau0Val').textContent = tau0.toFixed(1);
      document.getElementById('ybarVal').textContent = ybar.toFixed(1);
      document.getElementById('nVal').textContent = n;
      const taun = tau0 + n / (sigma * sigma);
      const mun = (tau0 * mu0 + n * ybar / (sigma * sigma)) / taun;
      const sigmaN = 1 / Math.sqrt(taun);
      draw(mu0, 1/Math.sqrt(tau0), mun, sigmaN);
    }
    function draw(priorMu, priorSig, postMu, postSig) {
      const svg = d3.select('#chart');
      svg.selectAll('*').remove();
      const w = 800, h = 250, m = {top:20,right:30,bottom:40,left:50};
      const g = svg.attr('viewBox', `0 0 ${w} ${h}`).append('g').attr('transform', `translate(${m.left},${m.top})`);
      const x = d3.scaleLinear().domain([-6, 6]).range([0, w-m.left-m.right]);
      const y = d3.scaleLinear().domain([0, 1.2]).range([h-m.top-m.bottom, 0]);
      g.append('g').attr('transform', `translate(0,${h-m.top-m.bottom})`).call(d3.axisBottom(x));
      g.append('g').call(d3.axisLeft(y));
      const line = d3.line().x(d => x(d[0])).y(d => y(d[1]));
      const xs = d3.range(-6, 6, 0.1);
      g.append('path').datum(xs.map(v => [v, normalPDF(v, priorMu, priorSig)])).attr('fill','none').attr('stroke','#ef4444').attr('stroke-width',2).attr('d',line);
      g.append('path').datum(xs.map(v => [v, normalPDF(v, postMu, postSig)])).attr('fill','none').attr('stroke','#10b981').attr('stroke-width',3).attr('d',line);
      // Legend
      g.append('text').attr('x', 10).attr('y', 20).attr('fill','#ef4444').text('Prior');
      g.append('text').attr('x', 10).attr('y', 40).attr('fill','#10b981').text('Posterior');
    }
    document.querySelectorAll('input').forEach(i => i.oninput = update);
    update();
  </script>
</body>
</html>
